# AutoGen 框架配置檔案範例
# 複製此檔案為 conf_autogen.yaml 並根據需要調整設定
# 生產環境配置
# environment: production
# debug: false

# AutoGen 基本設定
autogen:
  # 預設 LLM 配置
  default_llm_config:
    max_tokens: 100000
    timeout: 30

  # 智能體基本設定
  agent_defaults:
    max_consecutive_auto_reply: 10
    human_input_mode: "NEVER"
    code_execution_config: false

  # 群組對話設定
  group_chat:
    max_round: 50
    admin_name: "Admin"
    speaker_selection_method: "auto"
    allow_repeat_speaker: true

# 智能體角色配置
agents:
  coordinator_v3:
    name: "CoordinatorAgentV3"
    role: "coordinator"
    system_message: "你是協調者智能體，負責分析任務需求並協調整個研究工作流程。請以結構化的 JSON 格式回應，包含任務分析和工作流程策略。"
    llm_config_override:
      temperature: 0.3
      max_tokens: 2000

  planner_v3:
    name: "PlannerAgentV3"
    role: "planner"
    system_message: "你是規劃者智能體，負責制定詳細的執行計劃。請將任務分解為具體步驟，並以 JSON 格式回應計劃內容。"
    llm_config_override:
      temperature: 0.4
      max_tokens: 3000

  researcher_v3:
    name: "ResearcherAgentV3"
    role: "researcher"
    system_message: "你是研究者智能體，負責網路搜尋和資訊收集。使用可用工具進行研究，並以 JSON 格式回應研究結果。"
    tools:
      - "web_search"
      - "crawl_website"
      # - "local_search"
    llm_config_override:
      temperature: 0.2
      max_tokens: 4000

  coder_v3:
    name: "CoderAgentV3"
    role: "coder"
    system_message: "你是程式設計師智能體，負責程式碼分析和執行。使用 Python 執行環境進行數據處理和分析，並以 JSON 格式回應執行結果。"
    tools:
      - "python_repl"
    code_execution_config:
      work_dir: "temp_code_v3"
      use_docker: false
      timeout: 60
    llm_config_override:
      temperature: 0.0
      max_tokens: 5000

  reporter_v3:
    name: "ReporterAgentV3"
    role: "reporter"
    system_message: "你是報告者智能體，負責整理所有研究和分析結果，生成詳細的最終報告。請以 JSON 格式回應，並在完成時明確標示 'WORKFLOW_COMPLETE'。"
    llm_config_override:
      temperature: 0.0
      max_tokens: 6000

# 工作流程配置
workflows:
  research:
    enabled_agents:
      ["coordinator", "planner", "researcher", "coder", "reporter"]
    workflow_type: "sequential_with_feedback"
    human_feedback_steps: ["plan_review"]
    max_iterations: 3

  # V3 版本工作流程 (AutoGen SelectorGroupChat)
  research_v3:
    enabled_agents:
      [
        "coordinator_v3",
        "planner_v3",
        "researcher_v3",
        "coder_v3",
        "reporter_v3",
      ]
    workflow_type: "selector_group_chat"
    max_turns: 50
    allow_repeated_speaker: true
    termination_keywords: ["WORKFLOW_COMPLETE", "TERMINATE"]
    selector_config:
      use_custom_selector: true
      fallback_to_model: true
      max_selection_attempts: 3

  podcast:
    enabled_agents:
      ["coordinator", "script_writer", "tts_generator", "audio_mixer"]
    workflow_type: "pipeline"

  ppt:
    enabled_agents: ["coordinator", "content_organizer", "slide_generator"]
    workflow_type: "pipeline"

# 工具配置
tools:
  web_search:
    provider: "tavily" # tavily, brave_search, duckduckgo, arxiv, grounding_bing
    max_results: 5

  code_execution:
    timeout: 60
    max_execution_time: 300
    allowed_modules:
      - "pandas"
      - "numpy"
      - "matplotlib"
      - "requests"

  mcp_servers:
    github_trending:
      transport: "stdio"
      command: "uvx"
      args: ["mcp-github-trending"]
      enabled_tools: ["get_github_trending_repositories"]

# 模型配置
BASIC_MODEL:
  model: $AZURE_DEPLOYMENT_NAME_4_1_MINI
  azure_deployment: $AZURE_DEPLOYMENT_NAME_4_1_MINI
  azure_endpoint: $AZURE_OPENAI_ENDPOINT
  api_version: $BASIC_MODEL__API_VERSION
  api_key: $BASIC_MODEL__API_KEY
  verify_ssl: false
  model_type: "azure"

REASONING_MODEL:
  model: $AZURE_DEPLOYMENT_NAME_4_1
  azure_deployment: $AZURE_DEPLOYMENT_NAME_4_1
  azure_endpoint: $AZURE_OPENAI_ENDPOINT
  api_version: $BASIC_MODEL__API_VERSION
  api_key: $REASONING_MODEL__API_KEY
  verify_ssl: false
  model_type: "azure"

# Use Azure Open AI with key (from AutoGen example)
# provider: autogen_ext.models.openai.AzureOpenAIChatCompletionClient
# config:
#   model: $AZURE_DEPLOYMENT_NAME_4_1_MINI
#   azure_endpoint: $AZURE_OPENAI_ENDPOINT
#   azure_deployment: $AZURE_DEPLOYMENT_NAME_4_1_MINI
#   api_version: $BASIC_MODEL__API_VERSION
#   api_key: $BASIC_MODEL__API_KEY

# 記錄設定
LOGGING:
  # 提供者選項：file, sqlite://path/to/db.sqlite, postgresql://user:pass@host:port/dbname
  provider: "file"

  # 日誌級別設定
  level: "INFO"

  # 輸出設定
  console_output: true

  # 檔案設定
  file_settings:
    log_dir: "logs"
    max_days: 10
    compress_old_files: true

  # 外部套件日誌設定
  external_loggers:
    level: "ERROR"

  # 日誌格式設定
  format:
    main: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
    thread: "%(asctime)s - %(levelname)s - %(message)s"
